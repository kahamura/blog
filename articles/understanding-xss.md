# はじめに

# XSS とは

**XSS** とは、Cross Site Scripting の略で、Web サイトがユーザーからの入力をそのまま出力するようなセキュリティ上の不備がある場合、攻撃者がサイト間を横断させて悪意のあるスクリプトを挿入する攻撃のことです。

> クロスサイトスクリプティング (XSS) とは、悪意あるクライアントサイドのコードをウェブサイトに挿入するセキュリティ攻撃です。挿入されたコードは被害者のブラウザー上で実行され、アクセス制限の回避やユーザーへのなりすましなどにつながります。
>
> [MDN - Cross-site scripting](https://developer.mozilla.org/ja/docs/Glossary/Cross-site_scripting)

例えば、次のような会員制の掲示板サイトがあったとします。

![](https://storage.googleapis.com/zenn-user-upload/f458edd5bc1d-20220528.png)

この掲示板サイトでは、投稿したい内容をフォームに入力して「送信」ボタンをクリックすると、入力した内容が投稿一覧画面に表示されるような仕組みになっています。

この掲示板サイトは、基本的に一般的な掲示板サイトと同じような作りなのですが、1 つだけ他とは違う点があります。それは、投稿するテキストを自由に装飾できるように、入力フォームには **HTML を挿入することができる**という点です。

例えば、「○ 月 △ 日にイベントを開催します！」という内容を投稿するときに、日付の部分を強調したければ、`<b>○月△日</b>にイベントを開催します！` と入力します。

![](https://storage.googleapis.com/zenn-user-upload/08485123133e-20220528.png)

そうすることで、投稿一覧画面で表示されたときに、`<b>` タグで囲んだ部分が太字になります。他にも、`<a>` タグや `<img>`タグなどを必要に応じて使用することで、リンクや画像を埋め込むことができます。

このような機能は、HTML の知識さえあれば誰でも簡単に使いこなせるので、一見とても便利に感じられます。しかし、実はここに重大なセキュリティホールがあったのです。

例えば、悪質なユーザーが次のような内容を投稿したとします。

```html
<script>
  alert("You are attacked!");
</script>
```

すると、この Web ページを訪れたユーザーの画面には、次のようなアラートダイアログが表示されることになります。

![](https://storage.googleapis.com/zenn-user-upload/6c320eb2b847-20220528.png)

なぜなら、この Web サイトはユーザーが入力した内容をそのまま表示させているので、ユーザーが『**スクリプトに相当する文字列**』を埋め込んだ場合は、ブラウザは文字列としてではなく『**スクリプト**』として解釈して実行してしまうからです。

この例では、アラートダイアログが単に表示されるだけなので、大した被害はないと感じるかもしれません。しかし、Web ページ上に HTML タグや script タグを埋め込むことができると、ユーザーの機密情報が盗まれたり、Web ページを不正に改ざんされてしまうなどの危険に繋がります。これから解説していく XSS も、このような Web サイトの脆弱性を利用して攻撃を行う手法となっています。

では、具体的に XSS とはどういう攻撃手法なのでしょうか？次の章から XSS の攻撃について詳しく見ていきたいと思います。

# XSS の種類

XSS の種類は、3 つあります。

- 反射型 XSS（Reflected XSS）
- 格納型 XSS（Stored XSS）
- DOM ベースの XSS（DOM Based XSS）

まず、反射型 XSS から見ていきたいと思います。

# 反射型 XSS（Reflected XSS）
