# XSS とは

**XSS** とは、Cross Site Scripting の略で、Web サイトがユーザーからの入力をそのまま出力するようなセキュリティ上の不備がある場合、攻撃者がサイト間を横断させて悪意のあるスクリプトを挿入する攻撃のことです。

> クロスサイトスクリプティング (XSS) とは、悪意あるクライアントサイドのコードをウェブサイトに挿入するセキュリティ攻撃です。挿入されたコードは被害者のブラウザー上で実行され、アクセス制限の回避やユーザーへのなりすましなどにつながります。
>
> [MDN - Cross-site scripting](https://developer.mozilla.org/ja/docs/Glossary/Cross-site_scripting)

例えば、次のような会員制の掲示板サイトがあったとします。

[![Image from Gyazo](https://i.gyazo.com/7ac9cb2fd2dbb0f6059ff511041a2c2a.png)](https://gyazo.com/7ac9cb2fd2dbb0f6059ff511041a2c2a)

この掲示板サイトでは、投稿したい内容をフォームに入力して「送信」ボタンをクリックすると、入力した内容が投稿一覧画面に表示されるような仕組みになっています。

一般的な掲示板サイトと基本的に同じような作りなのですが、1 つだけ他とは違う点があります。それは、投稿するテキストを自由に装飾できるようにするために、入力フォームには **HTML タグを挿入できる**という点です。

例えば、イベントのお知らせをするときに、次のような内容を投稿したとします。

```html
<h1>お知らせ</h1>
イベントやります！ 場所は<b>東京駅周辺</b>です。
```

こういった機能は、HTML の知識さえあれば誰でも簡単に見た目を変えられるので、とても便利に感じられました。しかし、実はここに重大なセキュリティホールがあったのです。

例えば、悪質なユーザーが次のような内容を投稿したとします。

```html
<script>
  alert("You are attacked!");
</script>
```

すると、この Web ページを訪れたユーザーの画面上には、アラートダイアログが表示されることになってしまうでしょう。

[![Image from Gyazo](https://i.gyazo.com/67c2afc52d67d5da245b6cf58b996516.png)](https://gyazo.com/67c2afc52d67d5da245b6cf58b996516)
なぜなら、この Web サイトではユーザーが入力した内容をそのまま Web ページ上に出力しているため、埋め込まれたスクリプトは、ブラウザが Web ページの HTML を読み込むときに実行されてしまうのです。

今回の例では、単にアラートダイアログが表示されるだけなので、大した被害ではないと感じるかもしれません。しかし、Web サイト上に HTML タグや script タグを埋め込むことができると、ユーザーの機密情報が盗まれたり、Web ページが改ざんされたりなどの問題が発生する可能性があります。これから解説していく XSS も、このような Web サイトの脆弱性を利用して攻撃を行う手法となっています。

では、具体的に XSS とはどういう攻撃手法なのでしょうか。次の章から詳しく見ていきましょう。

# XSS の種類

XSS の種類は、3 つあります。

- 反射型 XSS（Reflected XSS）
- 格納型 XSS（Stored XSS）
- DOM ベースの XSS（DOM Based XSS）

まず、反射型 XSS から見ていきたいと思います。

# 反射型 XSS（Reflected XSS）
