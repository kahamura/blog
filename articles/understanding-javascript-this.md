---
title: "JavaScriptのthisを理解する"
date: "2022-04-14"
tags: ["JavaScript"]
---

# this とは

**this** とは、関数の中で使われる読み取り専用のキーワードです。基本的に this の中身は、その関数がどのように呼ばれたかによって決まります。そのため、this の中身は関数が呼び出されるたびに異なる可能性があります。

> ほとんどの場合、this の値はどのように関数が呼ばれたかによって決定されます (実行時結合)。これは実行時に代入によって設定することはできず、関数が呼び出されるたびに異なる可能性があります。
>
> 引用: [MDN - this](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/this)

では、this の中身はどのような条件で変化するのでしょうか？

この記事では 以下の 4 つのパターンに分けて、どのように this の中身が変化するのかを調査していきたいと思います。

1. トップレベルで単体で呼び出した場合
2. メソッドの場合
3. 関数の場合
4. コンストラクタの場合

# どのように this の値が決まるのか

調査にあたって、今回は事前に index.html を作成し、コードを次のとおりに記述しました。

コメント部分にあるように、基本的には `<script>` の中のコードを書き換えていきます。また、明記しない限りは非 Strict モードで実行することを前提とします。

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
  </head>

  <body>
    <h1>Hello World</h1>
    <script>
      // ここにコードを書いていく
    </script>
  </body>
</html>
```

## トップレベルで単体で呼び出した場合

では最初に、トップレベル（もっとも外側のスコープ）で this を単体で呼び出した場合はどうなるかを検証してみたいと思います。

さっそく `<script>` の中を以下のように書き換えてみましょう。

```html
<script>
  console.log(this);
</script>
```

実行した結果、コンソールには **Window** という名前のオブジェクトが出力されました。

![](https://storage.googleapis.com/zenn-user-upload/f0a712c5cfc0-20220402.png)

この Window とは、

### 2. メソッド呼び出しにおける this

- トップレベル（もっとも外側のスコープ）にある this は、実行コンテキストによって値が異なります。 実行コンテキストの違いは意識しにくい部分であり、トップレベルで this を使うと混乱を生むことになります。 そのため、コードのトップレベルにおいては this を使うべきではありませんが、それぞれの実行コンテキストにおける動作を紹介します。

### 3. 関数呼び出しにおける this

- コールバック関数
- アロー関数

### 4. コンストラクタ呼び出しにおける this

# use strict; とは

# call, apply, bind の役割
